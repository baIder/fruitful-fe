From 65cd65383adbc34368bc5b75e0ee3e96bbedceac Mon Sep 17 00:00:00 2001
From: frankfang <frankfang1990@gmail.com>
Date: Tue, 12 Apr 2022 10:30:35 +0800
Subject: [PATCH] =?UTF-8?q?=E5=AE=8C=E6=88=90=E6=AC=A2=E8=BF=8E=E7=95=8C?=
 =?UTF-8?q?=E9=9D=A2=E5=8A=A8=E7=94=BB?=
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

---
 src/App.scss                                  |  6 ++-
 src/App.tsx                                   |  4 +-
 src/components/welcome/First.tsx              | 17 +++-----
 src/components/welcome/FirstActions.tsx       | 12 ++++++
 src/components/welcome/Forth.tsx              | 20 +++-------
 src/components/welcome/ForthActions.tsx       | 11 ++++++
 src/components/welcome/Second.tsx             | 24 ++++--------
 src/components/welcome/SecondActions.tsx      | 12 ++++++
 src/components/welcome/Third.tsx              | 19 +++------
 src/components/welcome/ThirdActions.tsx       | 12 ++++++
 .../welcome/WelcomeLayout.module.scss         | 39 -------------------
 src/components/welcome/WelcomeLayout.tsx      | 16 --------
 src/components/welcome/welcome.module.scss    | 35 +++++++++++++++++
 src/config/routes.tsx                         | 12 ++++--
 src/views/Welcome.module.scss                 | 19 +++++++++
 src/views/Welcome.tsx                         | 18 +++++++--
 16 files changed, 154 insertions(+), 122 deletions(-)
 create mode 100644 src/components/welcome/FirstActions.tsx
 create mode 100644 src/components/welcome/ForthActions.tsx
 create mode 100644 src/components/welcome/SecondActions.tsx
 create mode 100644 src/components/welcome/ThirdActions.tsx
 delete mode 100644 src/components/welcome/WelcomeLayout.module.scss
 delete mode 100644 src/components/welcome/WelcomeLayout.tsx
 create mode 100644 src/components/welcome/welcome.module.scss

diff --git a/src/App.scss b/src/App.scss
index 043b404..ca9a69c 100644
--- a/src/App.scss
+++ b/src/App.scss
@@ -6,4 +6,8 @@ body{
   font-family: -apple-system, "Noto Sans", "Helvetica Neue", Helvetica, "Nimbus Sans L", Arial, "Liberation Sans", "PingFang SC", "Hiragino Sans GB", "Noto Sans CJK SC", "Source Han Sans SC", "Source Han Sans CN", "Microsoft YaHei", "Wenquanyi Micro Hei", "WenQuanYi Zen Hei", "ST Heiti", SimHei, "WenQuanYi Zen Hei Sharp", sans-serif;
   font-size: 16px;
   color: #333;
-}
\ No newline at end of file
+}
+
+::webkit-scrollbar {
+  visibility: hidden;
+}
diff --git a/src/App.tsx b/src/App.tsx
index 639f95c..1eddbae 100644
--- a/src/App.tsx
+++ b/src/App.tsx
@@ -1,5 +1,5 @@
-import { defineComponent } from "vue";
-import { RouterView } from "vue-router";
+import { defineComponent, Transition, VNode } from "vue";
+import { RouteLocationNormalizedLoaded, RouterView } from "vue-router";
 import "./App.scss"
 
 export const App = defineComponent({
diff --git a/src/components/welcome/First.tsx b/src/components/welcome/First.tsx
index 4335f48..9a3f32a 100644
--- a/src/components/welcome/First.tsx
+++ b/src/components/welcome/First.tsx
@@ -1,18 +1,11 @@
-import s from './WelcomeLayout.module.scss';
+import s from './welcome.module.scss';
 import pig from '../../assets/icons/pig.svg';
-import { WelcomeLayout } from './WelcomeLayout'
-import { RouterLink } from 'vue-router';
 import { FunctionalComponent } from 'vue';
 export const First: FunctionalComponent = () => {
-  return <WelcomeLayout>{{
-    icon: () => <img src={pig} />,
-    title: () => <h2>会挣钱<br />还会省钱</h2>,
-    buttons: () => <>
-      <RouterLink class={s.fake} to="/start" >跳过</RouterLink>
-      <RouterLink to="/welcome/2" >下一页</RouterLink>
-      <RouterLink to="/start" >跳过</RouterLink>
-    </>
-  }}</WelcomeLayout>
+  return <div class={s.card}>
+    <img src={pig}/>
+    <h2>会挣钱<br />还会省钱</h2>
+  </div>
 }
 
 First.displayName = 'First'
diff --git a/src/components/welcome/FirstActions.tsx b/src/components/welcome/FirstActions.tsx
new file mode 100644
index 0000000..e2580d2
--- /dev/null
+++ b/src/components/welcome/FirstActions.tsx
@@ -0,0 +1,12 @@
+import s from './welcome.module.scss';
+import { RouterLink } from 'vue-router';
+import { FunctionalComponent } from 'vue';
+export const FirstActions: FunctionalComponent = () => {
+  return <div class={s.actions}>
+    <RouterLink class={s.fake} to="/start" >跳过</RouterLink>
+    <RouterLink to="/welcome/2" >下一页</RouterLink>
+    <RouterLink to="/start" >跳过</RouterLink>
+  </div>
+}
+
+FirstActions.displayName = 'FirstActions'
diff --git a/src/components/welcome/Forth.tsx b/src/components/welcome/Forth.tsx
index 2ea4598..de4dec0 100644
--- a/src/components/welcome/Forth.tsx
+++ b/src/components/welcome/Forth.tsx
@@ -1,20 +1,10 @@
-import s from './WelcomeLayout.module.scss';
+import s from './welcome.module.scss';
 import cloud from '../../assets/icons/cloud.svg';
-import { RouterLink } from 'vue-router';
-import { WelcomeLayout } from './WelcomeLayout';
 export const Forth = () => (
-  <WelcomeLayout>
-    {{
-      icon: () => <img class={s.icon} src={cloud} />,
-      title: () => <h2>每日提醒<br />不遗漏每一笔账单</h2>,
-      buttons: () => <>
-        <RouterLink class={s.fake} to="/start" >跳过</RouterLink>
-        <RouterLink to="/start" >完成</RouterLink>
-        <RouterLink class={s.fake} to="/start" >跳过</RouterLink>
-      </>
-
-    }}
-  </WelcomeLayout>
+  <div class={s.card}>
+    <img class={s.icon} src={cloud} />
+    <h2>每日提醒<br />不遗漏每一笔账单</h2>
+  </div>
 )
 
 Forth.displayName = 'Forth'
\ No newline at end of file
diff --git a/src/components/welcome/ForthActions.tsx b/src/components/welcome/ForthActions.tsx
new file mode 100644
index 0000000..eb05808
--- /dev/null
+++ b/src/components/welcome/ForthActions.tsx
@@ -0,0 +1,11 @@
+import s from './welcome.module.scss';
+import { RouterLink } from 'vue-router';
+export const ForthActions = () => (
+  <div class={s.actions}>
+    <RouterLink class={s.fake} to="/start" >跳过</RouterLink>
+    <RouterLink to="/start" >完成</RouterLink>
+    <RouterLink class={s.fake} to="/start" >跳过</RouterLink>
+  </div>
+)
+
+ForthActions.displayName = 'ForthActions'
\ No newline at end of file
diff --git a/src/components/welcome/Second.tsx b/src/components/welcome/Second.tsx
index 3a3589a..884d25d 100644
--- a/src/components/welcome/Second.tsx
+++ b/src/components/welcome/Second.tsx
@@ -1,20 +1,12 @@
-import s from './WelcomeLayout.module.scss';
+import s from './welcome.module.scss';
 import clock from '../../assets/icons/clock.svg';
-import { RouterLink } from 'vue-router';
-import { WelcomeLayout } from './WelcomeLayout';
-export const Second = () => (
-  <WelcomeLayout>
-    {{
-      icon: () => <img class={s.icon} src={clock} />,
-      title: () => <h2>每日提醒<br />不遗漏每一笔账单</h2>,
-      buttons: () => <>
-        <RouterLink class={s.fake} to="/start" >跳过</RouterLink>
-        <RouterLink to="/welcome/3" >下一页</RouterLink>
-        <RouterLink to="/start" >跳过</RouterLink>
-      </>
-    }}
-  </WelcomeLayout>
-)
+import { FunctionalComponent } from 'vue';
 
+export const Second: FunctionalComponent = () => {
+  return <div class={s.card}>
+    <img class={s.icon} src={clock} />
+    <h2>每日提醒<br />不遗漏每一笔账单</h2>
+  </div>
+}
 
 Second.displayName = 'Second'
\ No newline at end of file
diff --git a/src/components/welcome/SecondActions.tsx b/src/components/welcome/SecondActions.tsx
new file mode 100644
index 0000000..d03eafe
--- /dev/null
+++ b/src/components/welcome/SecondActions.tsx
@@ -0,0 +1,12 @@
+import s from './welcome.module.scss';
+import { RouterLink } from 'vue-router';
+import { FunctionalComponent } from 'vue';
+export const SecondActions: FunctionalComponent = () => {
+  return <div class={s.actions}>
+    <RouterLink class={s.fake} to="/start" >跳过</RouterLink>
+    <RouterLink to="/welcome/3" >下一页</RouterLink>
+    <RouterLink to="/start" >跳过</RouterLink>
+  </div>
+}
+
+SecondActions.displayName = 'FirstActions'
diff --git a/src/components/welcome/Third.tsx b/src/components/welcome/Third.tsx
index 326a813..52abd6e 100644
--- a/src/components/welcome/Third.tsx
+++ b/src/components/welcome/Third.tsx
@@ -1,20 +1,11 @@
-import s from './WelcomeLayout.module.scss';
+import s from './welcome.module.scss';
 import chart from '../../assets/icons/chart.svg';
-import { RouterLink } from 'vue-router';
-import { WelcomeLayout } from './WelcomeLayout';
 export const Third = () => {
   return (
-    <WelcomeLayout>
-      {{
-        icon: () => <img class={s.icon} src={chart} />,
-        title: () => <h2>每日提醒<br />不遗漏每一笔账单</h2>,
-        buttons: () => <>
-          <RouterLink class={s.fake} to="/start" >跳过</RouterLink>
-          <RouterLink to="/welcome/4" >下一页</RouterLink>
-          <RouterLink to="/start" >跳过</RouterLink>
-        </>
-      }}
-    </WelcomeLayout>
+    <div class={s.card}>
+      <img class={s.icon} src={chart} />
+      <h2>每日提醒<br />不遗漏每一笔账单</h2>
+    </div>
   )
 }
 
diff --git a/src/components/welcome/ThirdActions.tsx b/src/components/welcome/ThirdActions.tsx
new file mode 100644
index 0000000..9b87595
--- /dev/null
+++ b/src/components/welcome/ThirdActions.tsx
@@ -0,0 +1,12 @@
+import s from './welcome.module.scss';
+import { RouterLink } from 'vue-router';
+import { FunctionalComponent } from 'vue';
+export const ThirdActions: FunctionalComponent = () => {
+  return <div class={s.actions}>
+    <RouterLink class={s.fake} to="/start" >跳过</RouterLink>
+    <RouterLink to="/welcome/4" >下一页</RouterLink>
+    <RouterLink to="/start" >跳过</RouterLink>
+  </div>
+}
+
+ThirdActions.displayName = 'ThirdActions'
diff --git a/src/components/welcome/WelcomeLayout.module.scss b/src/components/welcome/WelcomeLayout.module.scss
deleted file mode 100644
index f53c477..0000000
--- a/src/components/welcome/WelcomeLayout.module.scss
+++ /dev/null
@@ -1,39 +0,0 @@
-.wrapper{
-  flex-grow: 1;
-  display: flex;
-  flex-direction: column;
-  padding-bottom: var(--welcome-nav-gap);
-  > .card{
-    flex-grow: 1;
-    display: flex;
-    flex-direction: column;
-    background: var(--welcome-card-bg);
-    border-radius: 8px;
-    padding: 16px;
-    margin: 16px 16px 0;
-    display: flex;
-    justify-content: center;
-    align-items: center;
-    text-align: center;
-    > h2 {
-      margin-top: 40px;
-    }
-  }
-  > .actions{
-    position: fixed;
-    z-index: var(--z-index-bottom-nav);
-    background: var(--welcome-bg-end);
-    left: 0;
-    bottom: 0;
-    width: 100%;
-    display: flex;
-    justify-content: space-between;
-    align-items: center;
-    font-size: 24px;
-    height: var(--welcome-nav-height);
-    padding: 0 16px;
-    color: var(--welcome-text);
-    padding-bottom: var(--welcome-nav-gap);
-    > .fake{visibility: hidden;}
-  }
-}
\ No newline at end of file
diff --git a/src/components/welcome/WelcomeLayout.tsx b/src/components/welcome/WelcomeLayout.tsx
deleted file mode 100644
index 9ed9802..0000000
--- a/src/components/welcome/WelcomeLayout.tsx
+++ /dev/null
@@ -1,16 +0,0 @@
-import { FunctionalComponent } from 'vue';
-import s from './WelcomeLayout.module.scss';
-export const WelcomeLayout: FunctionalComponent = (props, context) => {
-  const { slots: { icon, title, buttons } } = context
-  return (
-    <div class={s.wrapper}>
-      <div class={s.card}>
-        {icon?.()}
-        {title?.()}
-      </div>
-      <div class={s.actions}>
-        {buttons?.()}
-      </div>
-    </div>
-  )
-}
diff --git a/src/components/welcome/welcome.module.scss b/src/components/welcome/welcome.module.scss
new file mode 100644
index 0000000..52eee23
--- /dev/null
+++ b/src/components/welcome/welcome.module.scss
@@ -0,0 +1,35 @@
+.card {
+  flex-grow: 1;
+  display: flex;
+  flex-direction: column;
+  background: var(--welcome-card-bg);
+  border-radius: 8px;
+  padding: 16px;
+  display: flex;
+  justify-content: center;
+  align-items: center;
+  text-align: center;
+  > h2 {
+    margin-top: 40px;
+  }
+}
+
+.actions {
+  position: fixed;
+  z-index: var(--z-index-bottom-nav);
+  background: var(--welcome-bg-end);
+  left: 0;
+  bottom: 0;
+  width: 100%;
+  display: flex;
+  justify-content: space-between;
+  align-items: center;
+  font-size: 24px;
+  height: var(--welcome-nav-height);
+  padding: 0 16px;
+  color: var(--welcome-text);
+  padding-bottom: var(--welcome-nav-gap);
+  > .fake {
+    visibility: hidden;
+  }
+}
diff --git a/src/config/routes.tsx b/src/config/routes.tsx
index df07662..d675161 100644
--- a/src/config/routes.tsx
+++ b/src/config/routes.tsx
@@ -1,8 +1,12 @@
 import { RouteRecordRaw } from "vue-router";
 import { First } from "../components/welcome/First";
+import { FirstActions } from "../components/welcome/FirstActions";
 import { Forth } from "../components/welcome/Forth";
+import { ForthActions } from "../components/welcome/ForthActions";
 import { Second } from "../components/welcome/Second";
+import { SecondActions } from "../components/welcome/SecondActions";
 import { Third } from "../components/welcome/Third";
+import { ThirdActions } from "../components/welcome/ThirdActions";
 import { Welcome } from "../views/Welcome";
 
 export const routes: RouteRecordRaw[] = [
@@ -12,10 +16,10 @@ export const routes: RouteRecordRaw[] = [
     component: Welcome,
     children: [
       { path: '', redirect: '/welcome/1', },
-      { path: '1', component: First, },
-      { path: '2', component: Second, },
-      { path: '3', component: Third, },
-      { path: '4', component: Forth, },
+      { path: '1', components: { main: First, footer: FirstActions }, },
+      { path: '2', components: { main: Second, footer: SecondActions }, },
+      { path: '3', components: { main: Third, footer: ThirdActions }, },
+      { path: '4', components: { main: Forth, footer: ForthActions }, },
     ]
   }
 ]
\ No newline at end of file
diff --git a/src/views/Welcome.module.scss b/src/views/Welcome.module.scss
index c8c41ce..08ae3b8 100644
--- a/src/views/Welcome.module.scss
+++ b/src/views/Welcome.module.scss
@@ -17,8 +17,27 @@
     flex-grow: 1;
     display: flex;
     flex-direction: column;
+    position: relative;
+    margin: 16px 16px var(--welcome-nav-gap);
   }
   > footer {
     flex-shrink: 0;
   }
 }
+
+.slide_fade_enter_active,
+.slide_fade_leave_active {
+  position: absolute;
+  left: 0;
+  top: 0;
+  width: 100%;
+  height: 100%;
+  transition: all 0.5s ease-out;
+}
+
+.slide_fade_enter_from {
+  transform: translateX(100vw);
+}
+.slide_fade_leave_to {
+  transform: translateX(-100vw);
+}
\ No newline at end of file
diff --git a/src/views/Welcome.tsx b/src/views/Welcome.tsx
index b93e64a..b772368 100644
--- a/src/views/Welcome.tsx
+++ b/src/views/Welcome.tsx
@@ -1,5 +1,5 @@
-import { defineComponent } from 'vue';
-import { RouterView } from 'vue-router';
+import { defineComponent, h, Transition, VNode } from 'vue';
+import { RouteLocationNormalizedLoaded, RouterView } from 'vue-router';
 import s from './Welcome.module.scss'
 import logo from '../assets/icons/mangosteen.svg'
 export const Welcome = defineComponent({
@@ -9,7 +9,19 @@ export const Welcome = defineComponent({
         <img src={logo} />
         <h1>山竹记账</h1>
       </header>
-      <main class={s.main}><RouterView /></main>
+      <main class={s.main}>
+        <RouterView name="main">
+          {({ Component: X, route: R }: { Component: VNode, route: RouteLocationNormalizedLoaded }) =>
+            <Transition enterFromClass={s.slide_fade_enter_from} enterActiveClass={s.slide_fade_enter_active}
+              leaveToClass={s.slide_fade_leave_to} leaveActiveClass={s.slide_fade_leave_active}>
+              {X}
+            </Transition>
+          }
+        </RouterView>
+      </main>
+      <footer>
+        <RouterView name="footer" />
+      </footer>
     </div>
   }
 })
\ No newline at end of file
-- 
2.40.0

